# JZGCCW 建设工程财务分析系统 - 使用说明

## 系统概述

本系统是基于《建设项目经济评价方法与参数(第三版)》编制的财务分析计算系统，完全复现了JZGCCW01.xls电子表格的计算功能，并提供了友好的Web用户界面。

## 功能特性

✅ **完整的财务分析计算**
- 项目投资估算
- 资产形成与折旧摊销
- 成本费用计算
- 利润分配计算
- 现金流量分析
- 财务指标计算

✅ **灵活的参数配置**
- 可动态调整建设期和运营期
- 年份数量自动生成
- 支持自定义各项参数

✅ **友好的用户界面**
- 可折叠侧边栏导航
- 按年横向布置的数据输入
- 清晰的表单布局

✅ **便捷的结果查看**
- 筛选式表格展示
- 支持多表同时查看
- 可导出CSV格式

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 启动应用

#### 方法一：使用启动脚本（推荐）
双击 `run_app.bat` 文件

#### 方法二：命令行启动
```bash
streamlit run app_v2.py
```

### 3. 访问应用

启动后，浏览器会自动打开，或者手动访问：
```
http://localhost:8501
```

## 使用指南

### 步骤1：设置全局参数

在页面顶部设置：
- **建设期**：项目建设所需年限（1-10年）
- **运营期**：项目运营年限（1-30年）
- **计算期**：自动显示（建设期+运营期）

### 步骤2：填写输入数据

在左侧侧边栏填写12个输入模块的数据：

#### 1️⃣ 基础信息
- 项目名称
- 项目类型

#### 2️⃣ 项目投资
- 工程费：建筑工程费、建筑设备费、安装费
- 工程建设其他费：管理费、技术服务费、配套设施费、土地使用费等
- 预备费：基本预备费率、涨价预备费率

#### 3️⃣ 资产形成
- 固定资产折旧年限
- 残值率
- 无形资产摊销年限

#### 4️⃣ 产品销售收入
- 按年输入运营期各年的销售收入

（其他输入模块待扩展）

### 步骤3：执行计算

点击页面中央的 **"🚀 执行计算"** 按钮

### 步骤4：查看结果

在下方结果区域：
1. 从多选框中选择要查看的表格
2. 系统会显示对应的计算表
3. 可以下载表格为CSV文件

## 可用的计算表

系统提供以下20个计算表供查看：

| 编号 | 表格名称 | 说明 |
|-----|---------|------|
| 1建设投资 | 建设投资估算表 | 各项投资估算明细 |
| 2流动资金 | 流动资金估算表 | 流动资金需求估算 |
| 3投资计划 | 项目总投资使用计划与资金筹措表 | 资金使用计划 |
| 4还本付息 | 借款还本付息计划表 | 贷款还款计划 |
| 5-1材料 | 外购原材料费估算表 | 原材料成本估算 |
| 5-2燃料 | 外购燃料及动力费估算表 | 燃料动力成本估算 |
| 5-3工资 | 工资及福利费估算表 | 人工成本估算 |
| 5-4折旧 | 固定资产折旧费估算表 | 折旧费用计算 |
| 5-5摊销 | 无形资产摊销估算表 | 摊销费用计算 |
| 5总成本 | 总成本费用估算表 | 年度总成本汇总 |
| 6收入 | 营业收入、营业税金及附加和增值税估算表 | 收入及税费 |
| 7利润 | 利润与利润分配表 | 利润计算与分配 |
| 8财务现金 | 项目财务现金流量表 | 财务现金流分析 |
| 9资产负债 | 资产负债表 | 资产负债状况 |
| 10项目现金 | 项目投资现金流量表 | 投资现金流分析 |
| 11资本金现金 | 项目资本金现金流量表 | 资本金现金流分析 |
| 12各方现金 | 投资各方现金流量表 | 各方现金流分析 |
| 财务分析结果汇总 | 财务分析结果汇总 | 关键财务指标汇总 |
| 土地增值税计算 | 土地增值税计算 | 土地增值税明细 |
| 房产销售及土增 | 房产销售及土增 | 房产销售收入与土增 |

## 数据说明

### 默认测试数据

系统内置了JZGCCW01.xls中的默认数据，可用于测试和验证计算结果。

### 单位说明

所有金额单位为：**万元人民币**

### 年份数据

- **建设期**：年份列显示为"第1年"、"第2年"、"第3年"
- **运营期**：从第4年开始（如果建设期为3年）
- **计算期**：建设期 + 运营期

## 技术架构

### 前端技术
- Streamlit：Web应用框架
- Python 3.8+

### 数据处理
- Pandas：数据处理
- OpenPyXL：Excel文件读写
- NumPy：数值计算

### 主要模块

```
JZGCCW-buddy/
├── app_v2.py              # 主应用入口
├── config.py              # 配置文件
├── data_loader.py         # Excel数据加载
├── data_models.py         # 数据模型定义
├── year_generator.py      # 动态年份生成器
├── calculations.py        # 计算逻辑模块
├── utils.py               # 工具函数
├── JZGCCW01.xls          # 原始Excel文件
└── requirements.txt      # 依赖列表
```

## 常见问题

### Q1: 如何修改建设期或运营期？
A: 在页面顶部的"全局设置"区域修改，年份数量会自动更新。

### Q2: 输入的数据会保存吗？
A: 当前版本数据在页面刷新后会重置。后续版本将增加数据保存功能。

### Q3: 如何验证计算结果是否正确？
A: 可以与JZGCCW01.xls中的原始数据进行对比，或使用系统提供的验证功能（待开发）。

### Q4: 支持导出数据吗？
A: 支持下载单个表格为CSV格式。后续将增加批量导出功能。

### Q5: 计算结果与Excel有差异怎么办？
A: 请检查输入数据是否一致，特别是：
- 各项费率设置
- 折旧和摊销年限
- 年份数量设置

## 版本信息

- **当前版本**：v2.0
- **更新日期**：2026年1月19日
- **开发状态**：核心功能已完成，持续优化中

## 联系与反馈

如有问题或建议，请通过以下方式反馈：
- 创建Issue
- 提交Pull Request

## 许可证

本系统仅供学习和参考使用。
